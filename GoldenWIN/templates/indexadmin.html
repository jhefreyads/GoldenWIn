<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="GOLDEN WIN">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    <meta name="theme-color" content="#1e1e1e">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOLDEN WIN</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="sidebar" id="mySidebar">
        <!-- Conteúdo da barra lateral -->
        <a href="#" class="close-button" onclick="toggleSidebar()">
            <i class="fas fa-times"></i>
        </a>
        <a href="#" class="username">{{ user_name }}</a>
        <a href="#" data-target="#home" onclick="selectSection(event)">Home</a>
        <a href="#" data-target="#analitico" onclick="selectSection(event)">Histórico</a>
        <a href="#" data-target="#calendario" onclick="selectSection(event)">Notícias</a>
        <a href="#" data-target="#status" onclick="selectSection(event)">Status</a>
        <a href="#" data-target="#config" onclick="selectSection(event)">Configurações</a>
        <a href="#" data-target="#users" onclick="selectSection(event)">Usuários</a>
        <a href="#" onclick="confirmLogout(event)">Logout</a>
    </div>

    <div class="container" id="mainContainer">
        <img src="/static/logo.png" alt="Logo" class="responsive-logo">

        <div class="header">
            <div class="nav nav-tabs">
                <button class="menu-button" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <a class="nav-link" href="#" data-target="#home" onclick="selectSection(event)">Home</a>
                <a class="nav-link" href="#" data-target="#analitico" onclick="selectSection(event)">Histórico</a>
                <a class="nav-link" href="#" data-target="#calendario" onclick="selectSection(event)">Notícias</a>
            </div>
        </div>

        <div id="home" class="content-section active">
            <div class="row">
                <div class="col-md-9">
                    <div class="card mb-3">
                        <div class="card-body clock-container">
                            <div class="clock" id="clock"></div>
                        </div>
                        <div class="card-body last-signal-container white-top-border">
                            <div class="last-signal" id="last_signal"></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card mb-3">
                        <div class="card-header">Resultados do Dia</div>
                        <div class="card-body last-signal-container">
                            <div id="daily_results"></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">Sinais Pendentes</div>
                        <div class="card-body">
                            <div id="pending_signals"></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">Últimos 5 Sinais</div>
                        <div class="card-body last-signal-container">
                            <div id="last_5_signals"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="analitico" class="content-section">
            <div class="card mb-3">
                <div class="card-header">Análise Detalhada</div>
                <div class="card-body" id="analitico_content">
                    <input type="text" id="searchInput" class="form-control" placeholder="Buscar ativo..." onkeyup="filterAssets()">
                    <div id="suggestions" class="list-group"></div>
                    <div id="mini_cards_container"></div> <!-- Container para os mini cards -->
                </div>
            </div>
        </div>

        <div id="calendario" class="content-section">
            <div class="card mb-6">
                <div class="card-header">Calendário Econômico</div>
                <div class="card-body" id="calendario_content">
                    <div id="events-container">
                        <!-- Os eventos serão carregados aqui -->
                    </div>
                </div>
            </div>
        </div>

        <div id="status" class="content-section">
            <div class="row">
                <div class="col-md-12">
                    <div class="script-container">
                        <div class="card mb-4">
                            <div class="card-header">Script: IA</div>
                            <div class="card-body">
                                <button class="btn btn-custom" id="button_ia.py" onclick="toggleScript('ia.py')">Iniciar IA</button>
                                <div class="console" id="ia_logs"></div>
                            </div>
                        </div>
                    </div>
                    <div class="script-container">
                        <div class="card mb-4">
                            <div class="card-header">Script: Telegram</div>
                            <div class="card-body">
                                <button class="btn btn-custom" id="button_telegrambot.py" onclick="toggleScript('telegrambot.py')">Iniciar Telegram</button>
                                <div class="console" id="telegram_logs"></div>
                            </div>
                        </div>
                    </div>
                    <div class="script-container">
                        <div class="card mb-4">
                            <div class="card-header">Script: Candles MT5</div>
                            <div class="card-body">
                                <button class="btn btn-custom" id="button_candles.py" onclick="toggleScript('candles.py')">Iniciar MT5</button>
                                <div class="console" id="candles_mt5_logs"></div>
                            </div>
                        </div>
                    </div>
                    <div class="script-container">
                        <div class="card mb-4">
                            <div class="card-header">Script: Candles OTC</div>
                            <div class="card-body">
                                <button class="btn btn-custom" id="button_candles_iq.py" onclick="toggleScript('candles_iq.py')">Iniciar OTC</button>
                                <div class="console" id="candles_iq_logs"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="config" class="content-section">
            <div class="row justify-content-center">
                <div class="col-md-9">
                    <div class="card mb-3">
                        <div class="card-header">Configurações</div>
                        <div class="card-body" id="config_content">
                            <div class="flag-container" id="flag1">
                                <label for="flag1_toggle">Validar Volatilidade:</label>
                                <label class="switch">
                                    <input type="checkbox" id="flag1_toggle" onchange="toggleFlag(this)">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <div class="flag-container" id="flag2">
                                <label for="flag2_toggle">Validar Volume:</label>
                                <label class="switch">
                                    <input type="checkbox" id="flag2_toggle" onchange="toggleFlag(this)">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <div class="flag-container" id="flag10">
                                <label for="flag10_toggle">Reiniciar Scripts Automaticamente:</label>
                                <label class="switch">
                                    <input type="checkbox" id="flag10_toggle" onchange="toggleFlag(this)">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="users" class="content-section active">
            <div class="row justify-content-center">
                <div class="col-md-12">
                    <div class="card mb-6">
                        <div class="card-header">Cadastro de Usuários</div>
        
                        <div class="tab">
                            <button class="tablinks" onclick="openTab('usuarios')">Usuários</button>
                            <button class="tablinks" onclick="openTab('licenses')">Licenças</button>
                        </div>
        
                        <div id="usuarios" class="tab-content active">
                            <div class="row justify-content-center">
                                <div class="col-md-12">
                                    <div class="card mb-6">
                                        <div class="card-header">Cadastro de Usuários</div>
                                        <div class="card-body">
                                            <!-- Formulário de cadastro de usuários -->
                                            <form id="createUserForm" action="/create_user_admin" method="POST">
                                                <div class="form-group">
                                                    <label for="new_name">Nome</label>
                                                    <input type="text" class="form-control" id="new_name" name="new_name" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="new_email">E-mail</label>
                                                    <input type="email" class="form-control" id="new_email" name="new_email" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="new_cpf">CPF</label>
                                                    <input type="text" class="form-control" id="new_cpf" name="new_cpf" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="new_password">Senha</label>
                                                    <input type="password" class="form-control" id="new_password" name="new_password" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="confirm_password">Confirmar Senha</label>
                                                    <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                                                </div>
                                                <button type="submit" class="btn btn-primary">Criar Usuário</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
        
                        <!-- Conteúdo da aba Licenças -->
                        <div id="licenses" class="tab-content">
                            <div class="row justify-content-center">
                                <div class="col-md-12">
                                    <div class="card mb-6">
                                        <div class="card-header">Cadastro de Licenças</div>
                                        <div class="card-body">
                                            <!-- Formulário de cadastro de licenças -->
                                            <form id="addLicenseForm" action="/add_license" method="post" onsubmit="handleFormSubmit(event)">
                                                <div class="form-group">
                                                    <label for="cpf">CPF:</label>
                                                    <input type="text" id="cpf" name="cpf" required><br>
                                                    <input type="hidden" id="data_pagamento" name="data_pagamento">
                                                </div>
                                                <div class="form-group">
                                                    <label for="prazo">Prazo (em dias):</label>
                                                    <input type="number" id="prazo" name="prazo" required><br>
                                                    <input type="hidden" id="id_usuario_criacao" name="id_usuario_criacao" value="{{ user_id }}" required>
                                                </div>
                                                <input type="submit" value="Adicionar Licença">
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> 
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Seleciona a aba "Home" ao carregar a página
        document.addEventListener("DOMContentLoaded", function() {
            // Remove a classe 'active' de todas as abas
            document.querySelectorAll('.nav-link').forEach(function(el) {
                el.classList.remove('active');
            });
            
            // Adiciona a classe 'active' à aba 'Home'
            document.querySelector('[data-target="#home"]').classList.add('active');
            
            // Remove a classe 'active' de todas as seções de conteúdo
            document.querySelectorAll('.content-section').forEach(function(el) {
                el.classList.remove('active');
            });
            
            // Adiciona a classe 'active' à seção de conteúdo 'Home'
            document.getElementById('home').classList.add('active');
        });
    </script>    


</body>
</html>
